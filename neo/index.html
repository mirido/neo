<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
    <link rel="stylesheet" type="text/css" media="all" href="styles.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>

    <script src="neo.js"></script>
	<script src="assets/painter.js"></script>
    <script src="assets/tools.js"></script>
    <script src="assets/commands.js"></script>
    <script src="assets/widgets.js"></script>
    <script src="assets/utils.js"></script>
    <script>
        var oe;
        var params;

//      var toolRadio;
//      var colorRadio;
//      var rgbaSlider;
//      var sizeSlider;

        function init() {
            /*
            -----------------------------------------------------------------------
            パラメーターチェック
            -----------------------------------------------------------------------
            */
            params = new Object;
            var pair = location.search.substring(1).split('&');
            for (var i = 0; pair[i]; i++) {
                var tmp = pair[i].split('=');
                params[tmp[0]] = tmp[1];
            }

            params.width = parseInt(params.width || 300);
            params.height = parseInt(params.height || 300);
            params.appletWidth = params.width > 250 ? params.width + 150 : 400;
            params.appletHeight = params.height > 240 ? params.height + 180 : 420;

            var canvas = document.getElementById("canvas");
            canvas.style.width = params.width + "px";
            canvas.style.height = params.height + "px";

            var container = document.getElementById("container");
            container.style.width = params.appletWidth + "px";
            container.style.height = params.appletHeight + "px";


            // コンポーネントの初期化
            initComponents();
            initButtons();
        }


        /*
        -----------------------------------------------------------------------
        コンポーネントの初期化
        -----------------------------------------------------------------------
        */
        function initComponents() {
            oe = new Neo.Painter();
//          oe.onUpdateCanvas = null; //updateCanvasHandler;
            var canvas = document.getElementById("canvas");
            oe.build(canvas, params.width, params.height);
            canvas.oncontextmenu = function() {return false;};

            document.getElementById("copyright").innerHTML += "v" + Neo.version;
        }

        /*
        -----------------------------------------------------------------------
        ボタンへの機能の割当
        -----------------------------------------------------------------------
        */

        function initButtons() {
            new Neo.Button().init("undo").onmouseup = function() {new Neo.UndoCommand(oe).execute();};
            new Neo.Button().init("redo").onmouseup = function () {new Neo.RedoCommand(oe).execute();};
            new Neo.Button().init("submit").onmouseup = function() {new Neo.SubmitCommand(oe).execute();};
            new Neo.Button().init("copyright").onmouseup = function() {new Neo.CopyrightCommand(oe).execute();};
            new Neo.Button().init("zoomPlus").onmouseup = function() {new Neo.ZoomPlusCommand(oe).execute();};
            new Neo.Button().init("zoomMinus").onmouseup = function() {new Neo.ZoomMinusCommand(oe).execute();};
        }

    </script>
    <title>PaintBBS NEO</title>
</head>

<body onLoad = "init();">

<div id="container" style="width:450px; height:470px; margin:auto;">
    <div id="center">
        <div id="painterContainer">
            <div id="tools">
            </div>
            <div id="painterWrapper">
                <div id="upper">
                    <div id="redo">やり直し</div>
                    <div id="undo">元に戻す</div>
               </div>
                <div id="painter">
                    <div id="canvas">
                         <div id="scrollH" data-ui=true></div>
                         <div id="scrollV" data-ui=true></div>
                         <div id="zoomPlusWrapper"><div id="zoomPlus">+</div></div>
                         <div id="zoomMinusWrapper"><div id="zoomMinus">-</div></div>
                    </div>
                </div>
                <div id="lower">
                </div>
            </div>
        </div>
    </div>
    <div id="headerButtons">
    </div>
    <div id="footerButtons">
        <div class="button" id="submit">投稿</div>
        <div class="button" id="copyright">(C)しいちゃん PaintBBS NEO</div>
    </div>
</div>

<!-- コントロール -->
<!--
<br>
<div>
<div class="toolTip"><div class="label">鉛筆</div></div>
<div class="toolTip"><div class="label">通常</div></div>
<div class="toolTip"><div class="label">消しペン</div></div>
<div class="toolTip"><div class="label">ﾃｷｽﾄ</div></div>
</div>

<div class="colorTips">
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-black.png" style="opacity:0.5;">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
    <br>
    <div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div><div class="colorTip">
        <img src="assets/images/topleft-white.png" style="opacity:0.9">
    </div>
</div>

<div class="colorSlider" style="margin:3px;">
    <div class="slider" style="width: 12px;"></div>
    <div class="label">R0</div>
</div>
<div class="colorSlider" style="margin:3px;">
    <div class="slider" style="width: 12px;"></div>
    <div class="label">G0</div>
</div>
<div class="colorSlider" style="margin:3px;">
    <div class="slider" style="width: 12px;"></div>
    <div class="label">B0</div>
</div>
<div class="colorSlider" style="margin:3px;">
    <div class="slider" style="width: 12px;"></div>
    <div class="label">A255</div>
</div>

<div class="sizeSlider" style="margin:3px;">
    <div class="slider" style="height: 12px;"></div>
<div class="label">9px</div>
</div>

<div class="reserveControl" style="margin:3px; margin-top:4px;">
</div>
<div class="layerControl" style="margin:3px; margin-top:6px;">
</div>
-->
<br>

<!-- 仮コントロール -->
<div style="margin:5px;">
<input id="colorTmp" type="color" onchange="oe.foregroundColor = this.value;"/>
<select style="font-size:14px;" onchange="console.log(this.value); oe.selectTool(this.value);">
<option value="1" selected=true>鉛筆
<option value="2">消しゴム
<option value="3">塗り潰し
</select>
</div>

<input id="widthTmp" type="range" value="1" min="1" max="30" step="1" onmousemove="oe.lineWidth = this.value-0; $('#lineWidth').html(this.value);" />
ペンの太さ: <span id="lineWidth">1</span>
<br>

<input id="alphaTmp" type="range" value="255" min="1" max="255" step="1" onmousemove="oe.alpha = this.value/255.0; $('#alpha').html(this.value)" />
透明度: <span id="alpha">1</span>
<br>


レイヤー
<select onchange="oe.current = this.value-0;">
<option>1
<option selected=true>0
</select>
<br>
1<input type="checkbox" checked=true onchange="oe.visible[1] = this.checked; oe.updateDestCanvas(0, 0, oe.canvasWidth, oe.canvasHeight)"/>
表示<br>
0<input type="checkbox" checked=true onchange="oe.visible[0] = this.checked; oe.updateDestCanvas(0, 0, oe.canvasWidth, oe.canvasHeight)"/>
表示<br>

<br>
マスク(とりあえず黒に固定)
<select onchange="oe.maskType = this.value-0;">
<option value="0" selected=true>通常
<option value="1">マスク
<option value="2">逆マスク
</select>

<hr>
<div>
    <input type="button" value="全消し" onclick="oe.clearCanvas(true);"/>
</div>

<div style="clear:both; padding-top:20px;">
    <select id="target" name="target">
        <option value="jun.2chan.net/oe">お絵sql</option>
        <option value="zip.2chan.net/p">お絵かき</option>
        <option value="nov.2chan.net/q">落書き</option>
        <option value="cgi.2chan.net/u">落書き裏</option>
    </select>
    <input id="submit" type="button" value="送信" 
           onclick="oe.submit(document.getElementById('target').value);">
</div>


</body>
</html>



